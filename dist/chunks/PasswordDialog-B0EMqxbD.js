var W=Object.defineProperty,Y=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var A=(p,m,u)=>m in p?W(p,m,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[m]=u,k=(p,m)=>{for(var u in m||(m={}))K.call(m,u)&&A(p,u,m[u]);if(M)for(var u of M(m))Q.call(m,u)&&A(p,u,m[u]);return p},B=(p,m)=>Y(p,G(m));var x=(p,m,u)=>new Promise((S,f)=>{var g=v=>{try{l(u.next(v))}catch(a){f(a)}},w=v=>{try{l(u.throw(v))}catch(a){f(a)}},l=v=>v.done?S(v.value):Promise.resolve(v.value).then(g,w);l((u=u.apply(p,m)).next())});import{a as U,S as z,t as N,m as L,w as $,b as s,e as n,u as i,C as y,c as b,p as C,h as O,o as _,H as X,n as j,F as ee,j as se}from"./vue-vendor-DAChQ3rz.js";import{_ as T,a as Z,b as H}from"../assets/index-wFKlhvRq.js";import{s as J}from"./dialog.esm-CYAWXk5o.js";import{s as c}from"./inputtext.esm-DAhs_0Nh.js";import{s as ae}from"./textarea.esm-D6i7G5ct.js";import{s as le}from"./calendar.esm-C4xoRl7p.js";import{s as q}from"./button.esm-tVDeXX10.js";import{s as oe}from"./avatar.esm-C27Wdo5a.js";import{s as I}from"./password.esm-Cxp4KApT.js";const te={class:"avatar-section"},re={class:"avatar-container"},ie={class:"avatar-info"},ne={class:"form-section"},de={class:"form-row"},ue={class:"form-field"},me={key:0,class:"p-error"},pe={class:"form-field"},fe={key:0,class:"p-error"},ve={class:"form-row"},ce={class:"form-field"},we={key:0,class:"p-error"},_e={class:"form-field"},ye={class:"form-section"},be={class:"form-row"},ge={class:"form-field"},he={class:"form-field"},Ve={class:"form-row"},Pe={class:"form-field"},Ce={class:"form-field"},ke={key:0,class:"form-help"},$e={class:"form-section"},Ue={class:"form-row full-width"},Se={class:"form-field"},Ne={class:"form-row"},De={class:"form-field"},Fe={class:"form-field"},Ee={class:"form-field"},ze={class:"form-section"},qe={class:"form-row"},Re={class:"form-field"},xe={class:"form-field"},Ie={class:"form-row"},Me={class:"form-field"},Ae={class:"dialog-footer"},Be={__name:"ProfileDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(p,{emit:m}){const u=p,S=m,f=Z(),g=H(),w=U(!1),l=U({}),v={first_name:"",last_name:"",email:"",phone:"",position:"",department:"",hire_date:null,address:"",city:"",state:"",zip_code:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relationship:""},a=U(k({},v)),h=z({get:()=>u.visible,set:r=>S("update:visible",r)}),V=r=>({admin:"Administrator",project_manager:"Project Manager",employee:"Employee"})[r]||r,D=()=>{const r=f.employee;r&&(a.value={first_name:r.first_name||"",last_name:r.last_name||"",email:r.email||"",phone:r.phone||"",position:r.position||"",department:r.department||"",hire_date:r.hire_date?new Date(r.hire_date):null,address:r.address||"",city:r.city||"",state:r.state||"",zip_code:r.zip_code||"",emergency_contact_name:r.emergency_contact_name||"",emergency_contact_phone:r.emergency_contact_phone||"",emergency_contact_relationship:r.emergency_contact_relationship||""})},R=()=>(l.value={},a.value.first_name||(l.value.first_name="First name is required"),a.value.last_name||(l.value.last_name="Last name is required"),a.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)||(l.value.email="Invalid email format"):l.value.email="Email is required",Object.keys(l.value).length===0),F=()=>x(null,null,function*(){var r,e,o;if(R()){w.value=!0;try{const d=B(k({},a.value),{hire_date:a.value.hire_date?new Date(a.value.hire_date).toISOString().split("T")[0]:null});yield f.updateProfile(d),g.add({severity:"success",summary:"Success",detail:"Profile updated successfully",life:3e3}),h.value=!1}catch(d){console.error("Error updating profile:",d),((r=d.response)==null?void 0:r.status)===422&&(l.value=d.response.data.errors||{}),g.add({severity:"error",summary:"Error",detail:((o=(e=d.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to update profile",life:5e3})}finally{w.value=!1}}}),E=()=>{a.value=k({},v),l.value={}};return N(()=>u.visible,r=>{r?D():E()}),(r,e)=>(_(),L(i(J),{visible:h.value,"onUpdate:visible":e[15]||(e[15]=o=>h.value=o),header:"Profile Settings",modal:!0,draggable:!1,resizable:!1,class:"profile-dialog"},{footer:$(()=>[s("div",Ae,[n(i(q),{label:"Cancel",severity:"secondary",onClick:e[14]||(e[14]=o=>h.value=!1),disabled:w.value},null,8,["disabled"]),n(i(q),{label:"Update Profile",loading:w.value,onClick:F,icon:"pi pi-check"},null,8,["loading"])])]),default:$(()=>{var o,d;return[s("form",{onSubmit:O(F,["prevent"]),class:"profile-form"},[s("div",te,[s("div",re,[n(i(oe),{label:i(f).employeeInitials,size:"xlarge",class:"user-avatar"},null,8,["label"]),s("div",ie,[s("h3",null,y(i(f).employeeFullName),1),s("p",null,y(V((o=i(f).employee)==null?void 0:o.role)),1)])])]),s("div",ne,[e[20]||(e[20]=s("h4",null,"Personal Information",-1)),s("div",de,[s("div",ue,[e[16]||(e[16]=s("label",{for:"firstName"},"First Name *",-1)),n(i(c),{id:"firstName",modelValue:a.value.first_name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.first_name=t),invalid:!!l.value.first_name,placeholder:"First name",class:"w-full"},null,8,["modelValue","invalid"]),l.value.first_name?(_(),b("small",me,y(l.value.first_name),1)):C("",!0)]),s("div",pe,[e[17]||(e[17]=s("label",{for:"lastName"},"Last Name *",-1)),n(i(c),{id:"lastName",modelValue:a.value.last_name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.last_name=t),invalid:!!l.value.last_name,placeholder:"Last name",class:"w-full"},null,8,["modelValue","invalid"]),l.value.last_name?(_(),b("small",fe,y(l.value.last_name),1)):C("",!0)])]),s("div",ve,[s("div",ce,[e[18]||(e[18]=s("label",{for:"email"},"Email *",-1)),n(i(c),{id:"email",modelValue:a.value.email,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.email=t),type:"email",invalid:!!l.value.email,placeholder:"Email address",class:"w-full"},null,8,["modelValue","invalid"]),l.value.email?(_(),b("small",we,y(l.value.email),1)):C("",!0)]),s("div",_e,[e[19]||(e[19]=s("label",{for:"phone"},"Phone",-1)),n(i(c),{id:"phone",modelValue:a.value.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.phone=t),placeholder:"Phone number",class:"w-full"},null,8,["modelValue"])])])]),s("div",ye,[e[26]||(e[26]=s("h4",null,"Work Information",-1)),s("div",be,[s("div",ge,[e[21]||(e[21]=s("label",{for:"position"},"Position",-1)),n(i(c),{id:"position",modelValue:a.value.position,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.position=t),placeholder:"Job position",class:"w-full"},null,8,["modelValue"])]),s("div",he,[e[22]||(e[22]=s("label",{for:"department"},"Department",-1)),n(i(c),{id:"department",modelValue:a.value.department,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.department=t),placeholder:"Department",class:"w-full"},null,8,["modelValue"])])]),s("div",Ve,[s("div",Pe,[e[23]||(e[23]=s("label",{for:"role"},"Role",-1)),n(i(c),{id:"role",value:V((d=i(f).employee)==null?void 0:d.role),disabled:"",class:"w-full"},null,8,["value"]),e[24]||(e[24]=s("small",{class:"form-help"},"Role cannot be changed. Contact administrator.",-1))]),s("div",Ce,[e[25]||(e[25]=s("label",{for:"hireDate"},"Hire Date",-1)),n(i(le),{id:"hireDate",modelValue:a.value.hire_date,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.hire_date=t),dateFormat:"yy-mm-dd",placeholder:"Select hire date",disabled:!i(f).hasRole("admin"),class:"w-full"},null,8,["modelValue","disabled"]),i(f).hasRole("admin")?C("",!0):(_(),b("small",ke,"Only administrators can modify this field."))])])]),s("div",$e,[e[31]||(e[31]=s("h4",null,"Contact Information",-1)),s("div",Ue,[s("div",Se,[e[27]||(e[27]=s("label",{for:"address"},"Address",-1)),n(i(ae),{id:"address",modelValue:a.value.address,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.address=t),rows:"2",placeholder:"Street address",class:"w-full"},null,8,["modelValue"])])]),s("div",Ne,[s("div",De,[e[28]||(e[28]=s("label",{for:"city"},"City",-1)),n(i(c),{id:"city",modelValue:a.value.city,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.city=t),placeholder:"City",class:"w-full"},null,8,["modelValue"])]),s("div",Fe,[e[29]||(e[29]=s("label",{for:"state"},"State",-1)),n(i(c),{id:"state",modelValue:a.value.state,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.state=t),placeholder:"State",class:"w-full"},null,8,["modelValue"])]),s("div",Ee,[e[30]||(e[30]=s("label",{for:"zipCode"},"Zip Code",-1)),n(i(c),{id:"zipCode",modelValue:a.value.zip_code,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.zip_code=t),placeholder:"Zip code",class:"w-full"},null,8,["modelValue"])])])]),s("div",ze,[e[35]||(e[35]=s("h4",null,"Emergency Contact",-1)),s("div",qe,[s("div",Re,[e[32]||(e[32]=s("label",{for:"emergencyName"},"Contact Name",-1)),n(i(c),{id:"emergencyName",modelValue:a.value.emergency_contact_name,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.emergency_contact_name=t),placeholder:"Emergency contact name",class:"w-full"},null,8,["modelValue"])]),s("div",xe,[e[33]||(e[33]=s("label",{for:"emergencyPhone"},"Contact Phone",-1)),n(i(c),{id:"emergencyPhone",modelValue:a.value.emergency_contact_phone,"onUpdate:modelValue":e[12]||(e[12]=t=>a.value.emergency_contact_phone=t),placeholder:"Emergency contact phone",class:"w-full"},null,8,["modelValue"])])]),s("div",Ie,[s("div",Me,[e[34]||(e[34]=s("label",{for:"emergencyRelationship"},"Relationship",-1)),n(i(c),{id:"emergencyRelationship",modelValue:a.value.emergency_contact_relationship,"onUpdate:modelValue":e[13]||(e[13]=t=>a.value.emergency_contact_relationship=t),placeholder:"Relationship to contact",class:"w-full"},null,8,["modelValue"])])])])],32)]}),_:1},8,["visible"]))}},us=T(Be,[["__scopeId","data-v-3351b5f0"]]),je={class:"form-section"},Le={class:"form-field"},Oe={class:"password-input-wrapper"},Te={key:0,class:"p-error"},Ze={class:"form-field"},He={class:"password-input-wrapper"},Je={class:"password-requirements"},We={key:0,class:"p-error"},Ye={class:"form-field"},Ge={class:"password-input-wrapper"},Ke={key:0,class:"p-error"},Qe={class:"dialog-footer"},Xe={__name:"PasswordDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(p,{emit:m}){const u=p,S=m,f=Z(),g=H(),w=U(!1),l=U({}),v={current_password:"",new_password:"",new_password_confirmation:""},a=U(k({},v)),h=[{label:"At least 8 characters long",test:e=>e.length>=8},{label:"Contains at least one uppercase letter",test:e=>/[A-Z]/.test(e)},{label:"Contains at least one lowercase letter",test:e=>/[a-z]/.test(e)},{label:"Contains at least one number",test:e=>/\d/.test(e)},{label:"Contains at least one special character",test:e=>/[!@#$%^&*(),.?":{}|<>]/.test(e)}],V=z({get:()=>u.visible,set:e=>S("update:visible",e)}),D=z(()=>h.every(e=>e.test(a.value.new_password))),R=z(()=>a.value.current_password&&a.value.new_password&&a.value.new_password_confirmation&&a.value.new_password===a.value.new_password_confirmation&&D.value),F=()=>(l.value={},a.value.current_password||(l.value.current_password="Current password is required"),a.value.new_password?D.value||(l.value.new_password="Password does not meet security requirements"):l.value.new_password="New password is required",a.value.new_password_confirmation?a.value.new_password!==a.value.new_password_confirmation&&(l.value.new_password_confirmation="Passwords do not match"):l.value.new_password_confirmation="Password confirmation is required",a.value.current_password&&a.value.new_password&&a.value.current_password===a.value.new_password&&(l.value.new_password="New password must be different from current password"),Object.keys(l.value).length===0),E=()=>x(null,null,function*(){var e,o,d,t;if(F()){w.value=!0;try{yield f.changePassword({current_password:a.value.current_password,new_password:a.value.new_password,new_password_confirmation:a.value.new_password_confirmation}),g.add({severity:"success",summary:"Success",detail:"Password changed successfully",life:3e3}),V.value=!1,r()}catch(P){console.error("Error changing password:",P),((e=P.response)==null?void 0:e.status)===422?l.value=P.response.data.errors||{}:((o=P.response)==null?void 0:o.status)===400&&(l.value.current_password="Current password is incorrect"),g.add({severity:"error",summary:"Error",detail:((t=(d=P.response)==null?void 0:d.data)==null?void 0:t.message)||"Failed to change password",life:5e3})}finally{w.value=!1}}}),r=()=>{a.value=k({},v),l.value={}};return N(()=>u.visible,e=>{e&&r()}),N(()=>a.value.current_password,()=>{l.value.current_password&&delete l.value.current_password}),N(()=>a.value.new_password,()=>{l.value.new_password&&delete l.value.new_password}),N(()=>a.value.new_password_confirmation,()=>{l.value.new_password_confirmation&&delete l.value.new_password_confirmation}),(e,o)=>(_(),L(i(J),{visible:V.value,"onUpdate:visible":o[4]||(o[4]=d=>V.value=d),header:"Change Password",modal:!0,draggable:!1,resizable:!1,class:"password-dialog"},{footer:$(()=>[s("div",Qe,[n(i(q),{label:"Cancel",severity:"secondary",onClick:o[3]||(o[3]=d=>V.value=!1),disabled:w.value},null,8,["disabled"]),n(i(q),{label:"Change Password",loading:w.value,onClick:E,icon:"pi pi-key",disabled:!R.value},null,8,["loading","disabled"])])]),default:$(()=>[s("form",{onSubmit:O(E,["prevent"]),class:"password-form"},[o[9]||(o[9]=s("div",{class:"form-intro"},[s("div",{class:"security-icon"},[s("i",{class:"pi pi-shield"})]),s("div",{class:"intro-text"},[s("h3",null,"Update Your Password"),s("p",null,"Choose a strong password to keep your account secure.")])],-1)),s("div",je,[s("div",Le,[o[5]||(o[5]=s("label",{for:"currentPassword"},"Current Password *",-1)),s("div",Oe,[n(i(I),{id:"currentPassword",modelValue:a.value.current_password,"onUpdate:modelValue":o[0]||(o[0]=d=>a.value.current_password=d),feedback:!1,toggleMask:"",invalid:!!l.value.current_password,placeholder:"Enter current password",class:"w-full"},null,8,["modelValue","invalid"])]),l.value.current_password?(_(),b("small",Te,y(l.value.current_password),1)):C("",!0)]),s("div",Ze,[o[7]||(o[7]=s("label",{for:"newPassword"},"New Password *",-1)),s("div",He,[n(i(I),{id:"newPassword",modelValue:a.value.new_password,"onUpdate:modelValue":o[1]||(o[1]=d=>a.value.new_password=d),feedback:!0,toggleMask:"",invalid:!!l.value.new_password,placeholder:"Enter new password",class:"w-full",pt:{meter:{class:"password-meter"},meterLabel:{class:"password-meter-label"}}},{header:$(()=>o[6]||(o[6]=[s("div",{class:"password-header"},[s("h4",null,"Password Requirements")],-1)])),content:$(({messages:d})=>[s("div",Je,[(_(),b(ee,null,X(h,(t,P)=>s("div",{key:P,class:j(["requirement-item",{"requirement-met":t.test(a.value.new_password)}])},[s("i",{class:j(t.test(a.value.new_password)?"pi pi-check":"pi pi-times")},null,2),s("span",null,y(t.label),1)],2)),64))])]),_:1},8,["modelValue","invalid"])]),l.value.new_password?(_(),b("small",We,y(l.value.new_password),1)):C("",!0)]),s("div",Ye,[o[8]||(o[8]=s("label",{for:"confirmPassword"},"Confirm New Password *",-1)),s("div",Ge,[n(i(I),{id:"confirmPassword",modelValue:a.value.new_password_confirmation,"onUpdate:modelValue":o[2]||(o[2]=d=>a.value.new_password_confirmation=d),feedback:!1,toggleMask:"",invalid:!!l.value.new_password_confirmation,placeholder:"Confirm new password",class:"w-full"},null,8,["modelValue","invalid"])]),l.value.new_password_confirmation?(_(),b("small",Ke,y(l.value.new_password_confirmation),1)):C("",!0)])]),o[10]||(o[10]=s("div",{class:"security-tips"},[s("h4",null,[s("i",{class:"pi pi-info-circle"}),se(" Security Tips ")]),s("ul",null,[s("li",null,"Use a unique password that you don't use elsewhere"),s("li",null,"Consider using a password manager"),s("li",null,"Avoid using personal information in your password"),s("li",null,"Change your password regularly")])],-1))],32)]),_:1},8,["visible"]))}},ms=T(Xe,[["__scopeId","data-v-40d294f6"]]);export{us as P,ms as a};
