var C=(L,c,u)=>new Promise((a,y)=>{var n=r=>{try{t(u.next(r))}catch(b){y(b)}},v=r=>{try{t(u.throw(r))}catch(b){y(b)}},t=r=>r.done?a(r.value):Promise.resolve(r.value).then(n,v);t((u=u.apply(L,c)).next())});import{a as A,r as S,S as P,y as h,J as T,U as R,t as j,c as _,e as p,b as s,w as m,j as f,m as $,p as w,u as l,C as k,n as U,E as D,h as K,o as g,K as W}from"../chunks/vue-vendor-DAChQ3rz.js";import{_ as x,a as z,b as J,l as O}from"../assets/index-wFKlhvRq.js";import{s as Y}from"../chunks/card.esm-CiQ1Wq-4.js";import{s as G}from"../chunks/inputtext.esm-DAhs_0Nh.js";import{s as H}from"../chunks/password.esm-Cxp4KApT.js";import{s as Q}from"../chunks/button.esm-tVDeXX10.js";import{s as X}from"../chunks/checkbox.esm-4WzbJXiL.js";import{s as q}from"../chunks/message.esm-CdnHGpMk.js";import"../chunks/overlayeventbus.esm-B_8idrPH.js";const Z={class:"login-container"},N={class:"login-header"},ee=["src"],se={class:"lockout-content"},oe={class:"field"},re={class:"input-wrapper"},te={key:0,id:"email-error",class:"field-error"},le={class:"field"},ae={class:"input-wrapper"},ie={key:0,id:"password-error",class:"field-error"},ne={class:"field checkbox-field"},de={class:"flex align-items-center"},ue={class:"forgot-password"},ce={class:"company-info"},me={class:"company-links"},pe={__name:"LoginForm",setup(L){const c=R(),u=T(),a=z(),y=J(),n=A(!1),v=A(null),t=S({email:"",password:"",rememberMe:!1}),r=S({email:null,password:null}),b={email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"},password:{required:!0,minLength:8,message:"Password must be at least 8 characters long"}},M=P(()=>t.email&&t.password&&!r.email&&!r.password&&!a.isAccountLocked),V=o=>{const e=t[o],i=b[o];return i?i.required&&(!e||e.trim()==="")?(r[o]=`${o.charAt(0).toUpperCase()+o.slice(1)} is required`,!1):i.pattern&&e&&!i.pattern.test(e)||i.minLength&&e&&e.length<i.minLength?(r[o]=i.message,!1):(r[o]=null,!0):!0},E=o=>{r[o]&&(r[o]=null)},B=()=>{let o=!0;return Object.keys(b).forEach(e=>{V(e)||(o=!1)}),o},F=()=>C(null,null,function*(){if(!B()){y.add({severity:"error",summary:"Validation Error",detail:"Please correct the errors below",life:5e3});return}n.value=!0;try{yield a.login({email:t.email.trim(),password:t.password,remember_me:t.rememberMe}),y.add({severity:"success",summary:"Login Successful",detail:`Welcome back, ${a.employeeFullName}!`,life:3e3});const o=u.query.redirect||"/employee/dashboard";c.push(o)}catch(o){console.error("Login error:",o),setTimeout(()=>{var e;(e=document.getElementById("email"))==null||e.focus()},100)}finally{n.value=!1}}),I=o=>{const e=Math.ceil(o/60);return e===1?"1 minute":`${e} minutes`};return h(()=>{const o=a.getRememberedEmail();o&&(t.email=o,t.rememberMe=!0),u.query.message&&(v.value=u.query.message,c.replace({query:{}})),setTimeout(()=>{var e,i;t.email?(e=document.getElementById("password"))==null||e.focus():(i=document.getElementById("email"))==null||i.focus()},100)}),j(()=>a.isAccountLocked,o=>{o&&(t.password="")}),(o,e)=>{const i=D("router-link");return g(),_("div",Z,[p(l(Y),{class:"login-card"},{header:m(()=>[s("div",N,[s("img",{src:l(O),alt:"Unified Contractors",class:"company-logo"},null,8,ee),e[8]||(e[8]=s("h1",{class:"login-title"},"Employee Portal",-1)),e[9]||(e[9]=s("p",{class:"login-subtitle"},"Sign in to access your projects and files",-1))])]),content:m(()=>[l(a).error?(g(),$(l(q),{key:0,severity:"error",closable:!1,class:"error-message"},{default:m(()=>[f(k(l(a).error),1)]),_:1})):w("",!0),l(a).isAccountLocked?(g(),$(l(q),{key:1,severity:"warn",closable:!1,class:"lockout-message"},{default:m(()=>[s("div",se,[e[11]||(e[11]=s("i",{class:"pi pi-lock"},null,-1)),s("div",null,[e[10]||(e[10]=s("strong",null,"Account Temporarily Locked",-1)),s("p",null,"Too many failed attempts. Please try again in "+k(I(l(a).lockoutTimeRemaining))+".",1)])])]),_:1})):w("",!0),v.value?(g(),$(l(q),{key:2,severity:"success",closable:!0,onClose:e[0]||(e[0]=d=>v.value=null),class:"success-message"},{default:m(()=>[f(k(v.value),1)]),_:1})):w("",!0),s("form",{onSubmit:K(F,["prevent"]),class:"login-form",novalidate:""},[s("div",oe,[e[13]||(e[13]=s("label",{for:"email",class:"field-label"},[f(" Email Address "),s("span",{class:"required","aria-label":"required"},"*")],-1)),s("div",re,[p(l(G),{id:"email",modelValue:t.email,"onUpdate:modelValue":e[1]||(e[1]=d=>t.email=d),type:"email",placeholder:"Enter your email address",class:U({"p-invalid":r.email}),disabled:n.value||l(a).isAccountLocked,autocomplete:"email",required:"","aria-describedby":"email-error",onBlur:e[2]||(e[2]=d=>V("email")),onInput:e[3]||(e[3]=d=>E("email"))},null,8,["modelValue","class","disabled"]),e[12]||(e[12]=s("i",{class:"pi pi-envelope input-icon"},null,-1))]),r.email?(g(),_("small",te,k(r.email),1)):w("",!0)]),s("div",le,[e[14]||(e[14]=s("label",{for:"password",class:"field-label"},[f(" Password "),s("span",{class:"required","aria-label":"required"},"*")],-1)),s("div",ae,[p(l(H),{id:"password",modelValue:t.password,"onUpdate:modelValue":e[4]||(e[4]=d=>t.password=d),placeholder:"Enter your password",class:U({"p-invalid":r.password}),disabled:n.value||l(a).isAccountLocked,feedback:!1,toggleMask:"",autocomplete:"current-password",required:"","aria-describedby":"password-error",onBlur:e[5]||(e[5]=d=>V("password")),onInput:e[6]||(e[6]=d=>E("password"))},null,8,["modelValue","class","disabled"])]),r.password?(g(),_("small",ie,k(r.password),1)):w("",!0)]),s("div",ne,[s("div",de,[p(l(X),{id:"rememberMe",modelValue:t.rememberMe,"onUpdate:modelValue":e[7]||(e[7]=d=>t.rememberMe=d),binary:!0,disabled:n.value||l(a).isAccountLocked},null,8,["modelValue","disabled"]),e[15]||(e[15]=s("label",{for:"rememberMe",class:"checkbox-label"}," Keep me signed in ",-1))])]),p(l(Q),{type:"submit",label:"Sign In",loading:n.value,disabled:n.value||l(a).isAccountLocked||!M.value,class:"login-button",icon:"pi pi-sign-in",iconPos:"right"},null,8,["loading","disabled"]),s("div",ue,[p(i,{to:"/employee/forgot-password",class:"forgot-link",tabindex:n.value?-1:0},{default:m(()=>e[16]||(e[16]=[f(" Forgot your password? ",-1)])),_:1,__:[16]},8,["tabindex"])])],32)]),footer:m(()=>e[17]||(e[17]=[s("div",{class:"login-footer"},[s("div",{class:"security-notice"},[s("i",{class:"pi pi-shield security-icon"}),s("small",{class:"security-text"}," Your connection is secured with 256-bit SSL encryption ")]),s("div",{class:"help-links"},[s("small",null,[f(" Need help? Contact your administrator or call "),s("a",{href:"tel:(555) 987-6543",class:"help-link"},"(555) 987-6543")])])],-1)])),_:1}),s("div",ce,[e[20]||(e[20]=s("p",null,"Â© 2024 Unified Contractors. All rights reserved.",-1)),s("div",me,[p(i,{to:"/",class:"company-link"},{default:m(()=>e[18]||(e[18]=[f("Visit Website",-1)])),_:1,__:[18]}),e[19]||(e[19]=s("a",{href:"tel:(555) 987-6543",class:"company-link"},"Call Us",-1))])])])}}},fe=x(pe,[["__scopeId","data-v-ffe8fec6"]]),ge={class:"login-view"},ve={__name:"LoginView",setup(L){return h(()=>{document.title="Employee Login - Unified Contractors";const c=document.querySelector('meta[name="description"]');c&&(c.content="Secure login portal for Unified Contractors employees. Access your projects, files, and team collaboration tools.")}),W(()=>{document.title="Unified Contractors"}),(c,u)=>(g(),_("div",ge,[p(fe)]))}},Ce=x(ve,[["__scopeId","data-v-ce824a8c"]]);export{Ce as default};
