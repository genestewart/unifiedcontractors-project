var G=(W,Z,y)=>new Promise((o,_)=>{var g=a=>{try{h(y.next(a))}catch(d){_(d)}},w=a=>{try{h(y.throw(a))}catch(d){_(d)}},h=a=>a.done?o(a.value):Promise.resolve(a.value).then(g,w);h((y=y.apply(W,Z)).next())});import{a as I,S as D,y as me,K as pe,t as ge,m as E,w as f,J as he,A as ye,o as n,b as t,e as v,j as N,n as ee,C as r,g as S,u as i,c,F as te,H as le,h as se,p as b}from"../chunks/vue-vendor-DAChQ3rz.js";import{_ as _e,b as we}from"../assets/index-wFKlhvRq.js";import{u as Ie,C as fe}from"../chunks/ClientReviewLayout-ByHysOP-.js";import{s as m}from"../chunks/button.esm-tVDeXX10.js";import{s as ie}from"../chunks/dialog.esm-CYAWXk5o.js";import{s as be}from"../chunks/dropdown.esm-DKpLOg4v.js";import{s as Ce}from"../chunks/progressspinner.esm-Hrgp9709.js";import"../chunks/inputtext.esm-DAhs_0Nh.js";import"../chunks/index.esm-CD-3j7eP.js";import"../chunks/overlayeventbus.esm-B_8idrPH.js";const ke={class:"client-gallery-page"},Fe={class:"gallery-header"},Se={class:"header-content"},xe={class:"header-info"},De={class:"gallery-title"},Ze={class:"gallery-description"},ze={class:"header-actions"},je={class:"gallery-content"},Ae={key:0,class:"loading-state"},Ee={key:1,class:"empty-state"},Ne={key:2,class:"gallery-grid"},We=["onClick"],Me={key:0,class:"item-thumbnail"},Pe=["src","alt"],Te={class:"item-overlay"},Ve={class:"overlay-actions"},Le={key:1,class:"item-document"},Be={class:"document-icon"},Ge=["src","alt"],Ue={class:"document-overlay"},He={class:"item-info"},Ye={class:"item-title"},Xe={class:"item-meta"},Re={class:"item-date"},$e={class:"item-size"},Qe={key:3,class:"gallery-list"},Je=["onClick"],qe={class:"list-icon"},Ke=["src","alt"],Oe=["src","alt"],et={class:"list-content"},tt={class:"list-title"},lt={class:"list-meta"},st={class:"meta-item"},it={class:"meta-item"},at={key:0,class:"meta-item"},ot={key:0,class:"list-description"},nt={class:"list-actions"},rt={class:"viewer-header"},ct={class:"viewer-nav"},dt={class:"image-counter"},ut={key:0,class:"image-viewer"},vt=["src","alt"],mt={class:"viewer-actions"},pt={class:"viewer-header"},gt={key:0,class:"document-viewer"},ht=["src"],yt={key:1,class:"document-preview"},_t={class:"preview-icon"},wt=["src","alt"],It={class:"viewer-actions"},ft={__name:"ClientGalleryView",props:{token:{type:String,required:!0},category:{type:String,default:null}},setup(W){const Z=W;he();const y=we(),o=Ie(),_=I("grid"),g=I(Z.category||"all"),w=I(!1),h=I(!1),a=I(null),d=I(0),z=I(!1),j=I(null),ae=D(()=>{const e=[{label:"All Files",value:"all"}];return o.fileCategories.forEach(s=>{e.push({label:s.label,value:s.name})}),e}),U=D(()=>{if(g.value==="all")return"All Files";const e=o.fileCategories.find(s=>s.name===g.value);return(e==null?void 0:e.label)||"Files"}),oe=D(()=>{if(g.value==="all")return"pi pi-folder";const e=o.fileCategories.find(s=>s.name===g.value);return(e==null?void 0:e.icon)||"pi pi-file"}),C=D(()=>g.value==="all"?o.projectFiles:o.projectFiles.filter(e=>e.category===g.value)),p=D(()=>C.value.filter(e=>k(e))),k=e=>{var s;return((s=e.mime_type)==null?void 0:s.startsWith("image/"))||/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(e.filename)},ne=e=>e.mime_type==="application/pdf"||e.filename.toLowerCase().endsWith(".pdf"),M=e=>e.split(".").pop().toUpperCase(),H=e=>e.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ").replace(/\b\w/g,u=>u.toUpperCase()),re=()=>{_.value=_.value==="grid"?"list":"grid"},ce=()=>{P()},de=()=>{g.value="all"},Y=(e,s)=>{a.value=e,k(e)?(d.value=p.value.findIndex(u=>u.id===e.id),w.value=!0):h.value=!0},P=()=>{w.value=!1,h.value=!1,a.value=null,V()},T=()=>{d.value>0&&(d.value--,a.value=p.value[d.value])},A=()=>{d.value<p.value.length-1&&(d.value++,a.value=p.value[d.value])},X=()=>{p.value.length<=1||(z.value=!0,j.value=setInterval(()=>{d.value<p.value.length-1?A():(d.value=0,a.value=p.value[0])},3e3),y.add({severity:"info",summary:"Slideshow Started",detail:"Images will change every 3 seconds",life:2e3}))},V=()=>{j.value&&(clearInterval(j.value),j.value=null,z.value=!1)},ue=()=>{var s,u;const e=document.documentElement;document.fullscreenElement?(u=document.exitFullscreen)==null||u.call(document):(s=e.requestFullscreen)==null||s.call(e)},L=e=>G(null,null,function*(){try{yield o.downloadFile(e),y.add({severity:"success",summary:"Download Started",detail:`${e.filename} download initiated`,life:2e3})}catch(s){y.add({severity:"error",summary:"Download Failed",detail:s.message,life:3e3})}}),R=()=>G(null,null,function*(){a.value&&(yield L(a.value))}),ve=()=>{},B=e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDIwMCAxMjAiIGZpbGw9Im5vbmUiPjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTIwIiBmaWxsPSIjZjFmNWY5Ii8+PGNpcmNsZSBjeD0iMTAwIiBjeT0iNjAiIHI9IjIwIiBmaWxsPSIjY2JkNWUxIi8+PHRleHQgeD0iNTAlIiB5PSI4MCIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzY0NzQ4YiIgZm9udC1zaXplPSIxMiI+SW1hZ2U8L3RleHQ+PC9zdmc+"},$=e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSI+PHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjOTRhM2I4IiByeD0iNCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSI4Ij5GSUxFPC90ZXh0Pjwvc3ZnPg=="};let Q=0,J=0;const q=e=>{Q=e.touches[0].clientX,J=e.touches[0].clientY},K=e=>{if(!w.value||p.value.length<=1)return;const s=e.changedTouches[0].clientX,u=e.changedTouches[0].clientY,l=s-Q,x=u-J;if(Math.abs(x)>Math.abs(l))return;const F=50;l>F?T():l<-F&&A()},O=e=>{if(w.value)switch(e.key){case"ArrowLeft":T();break;case"ArrowRight":A();break;case"Escape":P();break;case" ":e.preventDefault(),z.value?V():X();break}};return me(()=>{document.addEventListener("touchstart",q,{passive:!0}),document.addEventListener("touchend",K,{passive:!0}),document.addEventListener("keydown",O)}),pe(()=>{document.removeEventListener("touchstart",q),document.removeEventListener("touchend",K),document.removeEventListener("keydown",O),V()}),ge(()=>Z.category,e=>{e&&(g.value=e)},{immediate:!0}),(e,s)=>{const u=ye("tooltip");return n(),E(fe,null,{default:f(()=>[t("div",ke,[t("div",Fe,[t("div",Se,[t("div",xe,[t("h1",De,[t("i",{class:ee(oe.value)},null,2),N(" "+r(U.value),1)]),t("p",Ze,r(C.value.length)+" "+r(C.value.length===1?"item":"items")+" in "+r(U.value.toLowerCase()),1)]),t("div",ze,[v(i(be),{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=l=>g.value=l),options:ae.value,"option-label":"label","option-value":"value",placeholder:"All Categories",onChange:ce,class:"category-dropdown"},null,8,["modelValue","options"]),S(v(i(m),{icon:_.value==="grid"?"pi pi-list":"pi pi-th-large",onClick:re,severity:"secondary",size:"small"},null,8,["icon"]),[[u,_.value==="grid"?"List View":"Grid View"]])])])]),t("div",je,[i(o).loading?(n(),c("div",Ae,[v(i(Ce),{size:"60px"}),s[4]||(s[4]=t("h3",null,"Loading Files...",-1))])):C.value.length?_.value==="grid"?(n(),c("div",Ne,[(n(!0),c(te,null,le(C.value,(l,x)=>(n(),c("div",{key:l.id,class:ee(["gallery-item",{"image-item":k(l),"document-item":!k(l)}]),onClick:F=>Y(l,x)},[k(l)?(n(),c("div",Me,[t("img",{src:i(o).getThumbnailUrl(l,"medium"),alt:l.filename,loading:"lazy",onError:B},null,40,Pe),t("div",Te,[t("div",Ve,[S(v(i(m),{icon:"pi pi-eye",rounded:"",size:"small",severity:"info"},null,512),[[u,"View"]]),S(v(i(m),{icon:"pi pi-download",rounded:"",size:"small",severity:"secondary",onClick:se(F=>L(l),["stop"])},null,8,["onClick"]),[[u,"Download"]])])])])):(n(),c("div",Le,[t("div",Be,[t("img",{src:i(o).getFileTypeIcon(l.filename),alt:M(l.filename),onError:$},null,40,Ge)]),t("div",Ue,[S(v(i(m),{icon:"pi pi-eye",rounded:"",size:"small",severity:"info"},null,512),[[u,"View"]])])])),t("div",He,[t("h4",Ye,r(H(l.filename)),1),t("div",Xe,[t("span",Re,r(i(o).formatDate(l.created_at)),1),t("span",$e,r(i(o).getFileSize(l.size)),1)])])],10,We))),128))])):(n(),c("div",Qe,[(n(!0),c(te,null,le(C.value,(l,x)=>(n(),c("div",{key:l.id,class:"list-item",onClick:F=>Y(l,x)},[t("div",qe,[k(l)?(n(),c("img",{key:1,src:i(o).getThumbnailUrl(l,"small"),alt:l.filename,loading:"lazy",onError:B},null,40,Oe)):(n(),c("img",{key:0,src:i(o).getFileTypeIcon(l.filename),alt:M(l.filename),onError:$},null,40,Ke))]),t("div",et,[t("h4",tt,r(H(l.filename)),1),t("div",lt,[t("span",st,[s[8]||(s[8]=t("i",{class:"pi pi-calendar"},null,-1)),N(" "+r(i(o).formatDate(l.created_at)),1)]),t("span",it,[s[9]||(s[9]=t("i",{class:"pi pi-file"},null,-1)),N(" "+r(i(o).getFileSize(l.size)),1)]),l.category?(n(),c("span",at,[s[10]||(s[10]=t("i",{class:"pi pi-tag"},null,-1)),N(" "+r(i(o).getCategoryLabel(l.category)),1)])):b("",!0)]),l.description?(n(),c("p",ot,r(l.description),1)):b("",!0)]),t("div",nt,[S(v(i(m),{icon:"pi pi-eye",size:"small",severity:"info",text:""},null,512),[[u,"View"]]),S(v(i(m),{icon:"pi pi-download",size:"small",severity:"secondary",text:"",onClick:se(F=>L(l),["stop"])},null,8,["onClick"]),[[u,"Download"]])])],8,Je))),128))])):(n(),c("div",Ee,[s[5]||(s[5]=t("div",{class:"empty-icon"},[t("i",{class:"pi pi-images"})],-1)),s[6]||(s[6]=t("h3",null,"No Files Found",-1)),s[7]||(s[7]=t("p",null,"There are no files in this category yet.",-1)),v(i(m),{label:"View All Files",onClick:de,severity:"secondary"})]))]),v(i(ie),{visible:w.value,"onUpdate:visible":s[1]||(s[1]=l=>w.value=l),style:{width:"95vw",height:"95vh"},modal:"",maximizable:"",class:"image-viewer-dialog",contentStyle:{padding:0}},{header:f(()=>{var l;return[t("div",rt,[t("span",null,r((l=a.value)==null?void 0:l.filename),1),t("div",ct,[t("span",dt,r(d.value+1)+" of "+r(p.value.length),1)])])]}),footer:f(()=>[t("div",mt,[v(i(m),{label:"Download",icon:"pi pi-download",onClick:R,severity:"secondary"}),p.value.length>1?(n(),E(i(m),{key:0,label:"Slideshow",icon:"pi pi-play",onClick:X,severity:"info",disabled:z.value},null,8,["disabled"])):b("",!0),v(i(m),{label:"Close",onClick:P})])]),default:f(()=>[a.value?(n(),c("div",ut,[p.value.length>1?(n(),E(i(m),{key:0,icon:"pi pi-chevron-left",class:"nav-button nav-prev",onClick:T,disabled:d.value===0,rounded:"",size:"large"},null,8,["disabled"])):b("",!0),t("div",{class:"image-container",onClick:ue},[t("img",{src:i(o).getFileUrl(a.value),alt:a.value.filename,class:"viewer-image",onLoad:ve,onError:B},null,40,vt)]),p.value.length>1?(n(),E(i(m),{key:1,icon:"pi pi-chevron-right",class:"nav-button nav-next",onClick:A,disabled:d.value===p.value.length-1,rounded:"",size:"large"},null,8,["disabled"])):b("",!0)])):b("",!0)]),_:1},8,["visible"]),v(i(ie),{visible:h.value,"onUpdate:visible":s[3]||(s[3]=l=>h.value=l),style:{width:"95vw",height:"95vh"},modal:"",maximizable:"",class:"document-viewer-dialog",contentStyle:{padding:0}},{header:f(()=>{var l;return[t("div",pt,[t("span",null,r((l=a.value)==null?void 0:l.filename),1)])]}),footer:f(()=>[t("div",It,[v(i(m),{label:"Download",icon:"pi pi-download",onClick:R,severity:"secondary"}),v(i(m),{label:"Close",onClick:s[2]||(s[2]=l=>h.value=!1)})])]),default:f(()=>[a.value?(n(),c("div",gt,[ne(a.value)?(n(),c("iframe",{key:0,src:i(o).getFileUrl(a.value),class:"pdf-viewer",frameborder:"0"},null,8,ht)):(n(),c("div",yt,[t("div",_t,[t("img",{src:i(o).getFileTypeIcon(a.value.filename),alt:M(a.value.filename)},null,8,wt)]),t("h3",null,r(a.value.filename),1),t("p",null,r(i(o).getFileSize(a.value.size)),1),s[11]||(s[11]=t("p",null,"Click download to view this file type",-1))]))])):b("",!0)]),_:1},8,["visible"])])]),_:1})}}},Et=_e(ft,[["__scopeId","data-v-159cb645"]]);export{Et as default};
